<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dapla-manual – jobbe-med-kode</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/dapla-favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Ingen resultater",
    "search-matching-documents-text": "treff",
    "search-copy-link-title": "Kopier link til søk",
    "search-hide-matches-text": "Skjul flere treff",
    "search-more-match-text": "flere treff i dokumentet",
    "search-more-matches-text": "flere treff i dokumentet",
    "search-clear-button-title": "Nullstill",
    "search-detached-cancel-button-title": "Avbryt",
    "search-submit-button-title": "Send",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/dapla-long.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Dapla-manual</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://start.dapla.ssb.no/" rel="" target=""><i class="bi bi-people-fill" role="img" aria-label="Opprette Dapla-team">
</i> 
 <span class="menu-text">Opprette Dapla-team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://web.yammer.com/main/org/ssb.no/groups/eyJfdHlwZSI6Ikdyb3VwIiwiaWQiOiI5MDUzMjA2In0/all" rel="" target=""><i class="bi bi-question-lg" role="img">
</i> 
 <span class="menu-text">Stille spørsmål</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ssb.pureservice.com/#/new/7" rel="" target=""><i class="bi bi-send-fill" role="img" aria-label="Åpne en sak hos Kundeservice">
</i> 
 <span class="menu-text">Melde sak</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/statisticsnorway/dapla-manual" rel="" target=""><i class="bi bi-github" role="img" aria-label="Dapla-manual GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistikkproduksjon.html">Statistikkproduksjon</a></li><li class="breadcrumb-item"><a href="./produksjonsløp.html">Produksjonsløp</a></li><li class="breadcrumb-item"><a href="./jobbe-med-kode.html">Jobbe med kode</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Velkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Forord</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./introduksjon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduksjon</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hva-er-dapla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hva er Dapla?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./innlogging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Innlogging</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistikkproduksjon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistikkproduksjon</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./dapla-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dapla Team</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hva-er-dapla-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hva er Dapla-team?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./administrasjon-av-team.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Administrasjon av team</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gcc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Google Cloud Console</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./overføring-av-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overføring av data</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./produksjonsløp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Produksjonsløp</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./jobbe-med-kode.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Jobbe med kode</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./jobbe-med-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jobbe med data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hva-er-botter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hva er bøtter?</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./standarder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standarder</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datatilstander.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datatilstander</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./navnestandard-datalagring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Navnestandard datalagring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./versjonering-av-datasett.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Versjonering av datasett</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./kildedata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kildedata</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./automatisering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatisering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./automatisering-avansert.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatisering Avansert</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistikkbanken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistikkbanken</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./visualisering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualisering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dashboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dash og dashboard</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./annet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Annet</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git-og-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git og Github</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datadoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DataDoc</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./github-app-integrasjon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Koble prosjektet til Github</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gjenopprette-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gjenopprette data fra bøtter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spark.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spark</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slette-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slette data fra bøtter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./altinn3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Altinn 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kartdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kartdata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordforklaringer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ordforklaringer</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Innhold</h2>
   
  <ul>
  <li><a href="#jobbe-med-kode" id="toc-jobbe-med-kode" class="nav-link active" data-scroll-target="#jobbe-med-kode">Jobbe med kode</a></li>
  <li><a href="#ssb-project" id="toc-ssb-project" class="nav-link" data-scroll-target="#ssb-project">SSB-project</a>
  <ul class="collapse">
  <li><a href="#forberedelser" id="toc-forberedelser" class="nav-link" data-scroll-target="#forberedelser">Forberedelser</a></li>
  <li><a href="#opprett-ssb-project" id="toc-opprett-ssb-project" class="nav-link" data-scroll-target="#opprett-ssb-project">Opprett ssb-project</a>
  <ul class="collapse">
  <li><a href="#uten-github-repo" id="toc-uten-github-repo" class="nav-link" data-scroll-target="#uten-github-repo">Uten GitHub-repo</a></li>
  <li><a href="#med-github-repo" id="toc-med-github-repo" class="nav-link" data-scroll-target="#med-github-repo">Med Github-repo</a></li>
  </ul></li>
  <li><a href="#installere-pakker" id="toc-installere-pakker" class="nav-link" data-scroll-target="#installere-pakker">Installere pakker</a>
  <ul class="collapse">
  <li><a href="#avinstallere-pakker" id="toc-avinstallere-pakker" class="nav-link" data-scroll-target="#avinstallere-pakker">Avinstallere pakker</a></li>
  <li><a href="#oppdatere-pakker" id="toc-oppdatere-pakker" class="nav-link" data-scroll-target="#oppdatere-pakker">Oppdatere pakker</a></li>
  <li><a href="#undersøk-avhengigheter" id="toc-undersøk-avhengigheter" class="nav-link" data-scroll-target="#undersøk-avhengigheter">Undersøk avhengigheter</a></li>
  </ul></li>
  <li><a href="#push-til-github" id="toc-push-til-github" class="nav-link" data-scroll-target="#push-til-github">Push til GitHub</a></li>
  <li><a href="#dependabot" id="toc-dependabot" class="nav-link" data-scroll-target="#dependabot">Dependabot</a>
  <ul class="collapse">
  <li><a href="#aktivere-dependabot" id="toc-aktivere-dependabot" class="nav-link" data-scroll-target="#aktivere-dependabot">Aktivere Dependabot</a></li>
  <li><a href="#oppdatere-pakker-1" id="toc-oppdatere-pakker-1" class="nav-link" data-scroll-target="#oppdatere-pakker-1">Oppdatere pakker</a></li>
  </ul></li>
  <li><a href="#bygg-eksisterende-ssb-project" id="toc-bygg-eksisterende-ssb-project" class="nav-link" data-scroll-target="#bygg-eksisterende-ssb-project">Bygg eksisterende ssb-project</a></li>
  <li><a href="#slette-ssb-project" id="toc-slette-ssb-project" class="nav-link" data-scroll-target="#slette-ssb-project">Slette ssb-project</a>
  <ul class="collapse">
  <li><a href="#lokalt" id="toc-lokalt" class="nav-link" data-scroll-target="#lokalt">Lokalt</a></li>
  <li><a href="#arkiver-github-repo" id="toc-arkiver-github-repo" class="nav-link" data-scroll-target="#arkiver-github-repo">Arkiver GitHub-repo</a></li>
  </ul></li>
  <li><a href="#spark-i-ssb-project" id="toc-spark-i-ssb-project" class="nav-link" data-scroll-target="#spark-i-ssb-project">Spark i ssb-project</a>
  <ul class="collapse">
  <li><a href="#lokal-maskin" id="toc-lokal-maskin" class="nav-link" data-scroll-target="#lokal-maskin">Lokal maskin</a></li>
  <li><a href="#cluster" id="toc-cluster" class="nav-link" data-scroll-target="#cluster">Cluster</a></li>
  </ul></li>
  <li><a href="#tips-og-triks" id="toc-tips-og-triks" class="nav-link" data-scroll-target="#tips-og-triks">Tips og triks</a>
  <ul class="collapse">
  <li><a href="#poetry" id="toc-poetry" class="nav-link" data-scroll-target="#poetry">Poetry</a></li>
  <li><a href="#full-disk-på-dapla" id="toc-full-disk-på-dapla" class="nav-link" data-scroll-target="#full-disk-på-dapla">Full disk på Dapla</a></li>
  <li><a href="#hold-prosjektet-oppdatert" id="toc-hold-prosjektet-oppdatert" class="nav-link" data-scroll-target="#hold-prosjektet-oppdatert">Hold prosjektet oppdatert</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#r-og-renv" id="toc-r-og-renv" class="nav-link" data-scroll-target="#r-og-renv">R og renv</a>
  <ul class="collapse">
  <li><a href="#starte-en-ny-renv" id="toc-starte-en-ny-renv" class="nav-link" data-scroll-target="#starte-en-ny-renv">Starte en ny renv</a></li>
  <li><a href="#installering-av-pakker" id="toc-installering-av-pakker" class="nav-link" data-scroll-target="#installering-av-pakker">Installering av pakker</a></li>
  <li><a href="#lagre-pakkeversjonen-til-renv" id="toc-lagre-pakkeversjonen-til-renv" class="nav-link" data-scroll-target="#lagre-pakkeversjonen-til-renv">Lagre pakkeversjonen til renv</a></li>
  <li><a href="#avinstallering" id="toc-avinstallering" class="nav-link" data-scroll-target="#avinstallering">Avinstallering</a></li>
  <li><a href="#oppgradere-pakker" id="toc-oppgradere-pakker" class="nav-link" data-scroll-target="#oppgradere-pakker">Oppgradere pakker</a></li>
  <li><a href="#hva-skal-stå-i-kjørekoden" id="toc-hva-skal-stå-i-kjørekoden" class="nav-link" data-scroll-target="#hva-skal-stå-i-kjørekoden">Hva skal stå i kjørekoden?</a></li>
  <li><a href="#r-på-bakken" id="toc-r-på-bakken" class="nav-link" data-scroll-target="#r-på-bakken">R på bakken</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="jobbe-med-kode" class="level1">
<h1>Jobbe med kode</h1>
<p>På Dapla jobber vi med utvikling av Python- og R-kode i et Jupyter-miljø. For de som ønsker det, er det mulig å enkelt åpne en notebook med en av våre forhåndskonfigurerte kernels<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Man kan umiddelbart begynne å skrive kode og deretter lagre den i det lokale filsystemet. Dette er ideelt for enkel datautforskning eller for pedagogiske formål.</p>
<p>Når koden skal settes i produksjon, er det essensielt å ta hensyn til følgende:</p>
<ul>
<li>Resultater bør være reproduserbare.</li>
<li>Koden må kunne deles med andre.</li>
<li>Koden bør være organisert slik at den er gjenkjennelig for kollegaer.</li>
</ul>
<p>For å lette etterlevelsen av beste praksis for kodeutvikling på Dapla, har vi utviklet et verktøy kalt ssb-project. Dette er et CLI-verktøy<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> som enkelt lar deg opprette et prosjekt med en standard mappestruktur, et virtuelt miljø og integrasjon med Git for versjonshåndtering. Som en bonus kan det også opprette et GitHub-repositorium for deg ved behov.</p>
<p>I dette kapitlet vil vi veilede deg gjennom bruken av ssb-project. Du vil lære å opprette et nytt prosjekt, installere pakker, håndtere versjoner med Git, bygge et eksisterende prosjekt og vedlikeholde prosjektet over tid.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
SSB-project støtter ikke R enda
</div>
</div>
<div class="callout-body-container callout-body">
<p>Per nå støtter SSB-project kun prosjekter skrevet i Python. Dette skyldes begrensninger ved det populære virtuelle miljø-verktøyet for R, <a href="https://rstudio.github.io/renv/index.html">renv</a>. Mens renv effektivt håndterer versjoner av R-pakker, har det ikke kapasitet til å ta vare på spesifikke R-installasjonsversjoner. Dette kan potensielt gjøre det mer utfordrende å reprodusere tidligere publiserte resultater ved bruk av ssb-project. Vi arbeider mot en løsning for å inkludere støtte for R i fremtiden.</p>
</div>
</div>
</section>
<section id="ssb-project" class="level1">
<h1>SSB-project</h1>
<p>SSB-project er et verktøy som hjelper deg med følgende:</p>
<ul>
<li>versjonshåndtere kode med <strong>Git</strong></li>
<li>opprette et <strong>GitHub</strong>-repo</li>
<li>opprette et <strong>virtuelt miljø</strong> som husker hvilke versjoner av pakker og programmeringsspråk du brukte</li>
<li>opprette en <strong>Jupyter kernel</strong> som kan brukes i Jupyterlab</li>
<li>konfigurere prosjektet til å passe med enten prodsonen eller Dapla.</li>
</ul>
<p>Vi mener at <strong>ssb-project</strong> er et naturlig sted å starte når man skal bygge opp koden i Python eller R. Det gjelder både på bakken og på sky. I denne delen av kapitlet forklarer vi deg hvordan du kan ta i bruk <strong>ssb-project</strong>.</p>
<p>Kort fortalt kan du kjøre denne kommandoen i en terminal:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssb-project</span> create stat-testprod</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Da vil få en mappe som heter <strong>stat-testprod</strong> med følgende innhold:</p>
<ol type="1">
<li><strong>Standard mappestruktur</strong> En standard mappestruktur gjør det lettere å dele og samarbeide om kode, som igjen reduserer sårbarheten knyttet til at få personer kjenner koden.</li>
<li><strong>Virtuelt miljø</strong> Virtuelle miljøer isolerer og lagrer informasjon knyttet til kode. For eksempel hvilken versjon av Python du bruker og tilhørende pakkeversjoner. Det er viktig for at publiserte tall skal være reproduserbare. Verktøyet for å lage virtuelt miljø er <a href="https://python-poetry.org/docs/">Poetry</a>.</li>
<li><strong>Versjonshåndtering med Git</strong> Initierer versjonshåndtering med <a href="https://git-scm.com/">Git</a> og legger til SSBs anbefalte <em>.gitignore</em> og <em>.gitattributes</em>. Det sikrer at du ikke versjonhåndterer filer/informasjon som ikke skal versjonshåndteres.</li>
</ol>
<p>I tillegg lar <strong>ssb-project</strong> deg opprette et GitHub-repo hvis du ønsker. Hvis du velger å la <strong>ssb-project</strong> opprette et GitHub-repo for deg, så vil det også sette opp SSBs anbefalte GitHub-oppsett. Det er viktig for at du skal kunne dele koden din med andre i SSB på en sikker måte.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dokumentasjonen for <code>ssb-project</code> finnes her: <a href="https://statisticsnorway.github.io/ssb-project-cli/" class="uri">https://statisticsnorway.github.io/ssb-project-cli/</a>. Det oppdateres hver gang en ny versjon av <code>ssb-project</code> slippes.</p>
</div>
</div>
<section id="forberedelser" class="level2">
<h2 class="anchored" data-anchor-id="forberedelser">Forberedelser</h2>
<p>Før du kan ta i bruk <strong>ssb-project</strong> så er det et par ting som må være på plass:</p>
<ol type="1">
<li>Du må ha konfigurert Git etter SSB sin standard (<a href="./git-og-github.html#oppsett-av-git">les mer om hvordan her</a>).</li>
<li>Hvis du ønsker at <strong>ssb-project</strong> også skal opprette et GitHub-repo for deg må du også følgende være på plass:
<ol type="a">
<li>Du må ha en <strong>GitHub-bruker</strong> (<a href="./git-og-github.html#opprett-github-bruker">les hvordan her</a>)</li>
<li>Skru på <strong>2-faktor autentifisering</strong> for GitHub-brukeren din (<a href="./git-og-github.html#sec-tofaktor">les hvordan her</a>)</li>
<li>Være koblet mot SSBs organisasjon <a href="https://github.com/statisticsnorway">statisticsnorway</a> på GitHub (<a href="./git-og-github.html#koble-deg-til-ssb">les hvordan her</a>)</li>
<li>Opprette <strong>Personal Access Token (PAT)</strong> og godkjenne det for bruk mot <strong>statisticsnorway</strong> (<a href="./git-og-github.html#personal-access-token-pat">les hvordan her</a>)</li>
</ol></li>
</ol>
<p>Det er også å anbefale at du <a href="./git-og-github.html#lagre-pat">lagrer PAT lokalt</a> slik at du ikke trenger å forholde deg til det når jobber med Git og GitHub. Hvis du har alt dette på plass så kan du bare fortsette å følge de neste kapitlene.</p>
</section>
<section id="opprett-ssb-project" class="level2">
<h2 class="anchored" data-anchor-id="opprett-ssb-project">Opprett ssb-project</h2>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Har du Github bruker? Noe funksjonalitet i <code>ssb-project</code> krever det. Finn ut hvordan ved å lese <a href="https://jupyter.dapla.ssb.no/user/obr@ssb.no/proxy/4272/nytt-ssbproject.html#forberedelser">forrige kapittel</a>.</p>
</div>
</div>
</div>
<p><strong>ssb-project</strong> lar deg opprette en prosjekt-mappe med og uten GitHub-repo. La oss ta for oss hver av alternativene.</p>
<section id="uten-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="uten-github-repo">Uten GitHub-repo</h3>
<p>For å opprette et nytt <strong>ssb-project</strong> uten GitHub-repo gjør du følgende:</p>
<ol type="1">
<li><p>Åpne en terminal. De fleste vil gjøre dette i Jupyterlab på bakke eller sky og da kan de bare trykke på det blå ➕-tegnet i Jupyterlab og velge <strong>Terminal</strong>.</p></li>
<li><p>Før vi kjører programmet må vi være obs på at <strong>ssb-project</strong> vil opprette en ny mappe der vi står. Gå derfor til den mappen du ønsker å ha den nye prosjektmappen. For å opprette et prosjekt som heter <strong>stat-testprod</strong> så skriver du følgende i terminalen:</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssb-project</span> create stat-testprod</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="grid">
<div class="g-col-8">
<p>Hvis du stod i hjemmemappen din på når du skrev inn kommandoen over i terminalen, så har du fått mappestrukturen som vises i <a href="#fig-ssb-proj-folder">Figur&nbsp;1</a>. <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Den inneholder følgende :</p>
<ul>
<li><strong>.git</strong>-mappe som blir opprettet for å versjonshåndtere med Git.</li>
<li><strong>src</strong>-mappe som skal inneholde all koden som utgjør produksjonsløpet.</li>
<li><strong>tests</strong>-mappe som inneholder tester du skriver for koden din.</li>
<li><strong>LICENCE</strong>-fil som skal benyttes for public-repos i SSB.</li>
<li><strong>poetry.lock</strong>-fil som inneholder alle versjoner av Python-pakker som blir brukt.</li>
<li><strong>pyproject.toml</strong>-fil som inneholder informasjon om prosjektet og hvilke pakker som blir brukt.</li>
<li><strong>README.md</strong>-fil som brukes for tekstlig innhold på GitHub-siden for prosjektet.</li>
</ul>
</div>
<div class="g-col-4">
<div id="fig-ssb-proj-folder" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/ssbproject_folders.png" class="img-fluid figure-img" alt="Bilde av filutforskeren i Jupyterlab med en mappe laget av ssb-project"></p>
<figcaption class="figure-caption">Figur&nbsp;1: Mappen som ble opprettet av ssb-project.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="med-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="med-github-repo">Med Github-repo</h3>
<p>Over så opprettet vi et <strong>ssb-project</strong> uten å opprette et GitHub-repo. Hvis du ønsker å opprette et GitHub-repo også må du endre kommandoen over til:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssb-project</span> create stat-testprod <span class="at">--github</span> <span class="at">--github-token</span><span class="op">=</span><span class="st">'blablabla'</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Kommandoen over oppretter en mappestruktur slik vi så tidligere, men også et ssb-project som heter <strong>stat-testprod</strong> med et GitHub-repo med samme navn. Som du ser så må vi da sende med opsjonen <code>--github</code> og PAT med opsjonen <code>--github-token='blablabla'</code>. Repoet i GitHub ser da ut som i <a href="#fig-ssb-proj-github">Figur&nbsp;2</a>. Hvis du ønsker å slippe måtte forholde deg til PAT hver gang interagerer med GitHub, kan du følge <a href="./git-og-github.html#personal-access-token-(pat)">denne beskrivelsen</a> for å lagre den lokalt. Da kan droppe <code>--github-token='blablabla'</code> fra kommandoen over.</p>
<div id="fig-ssb-proj-github" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/ssbproject_github.png" class="img-fluid figure-img" alt="Bilde av et GitHub-repo som ble opprettet av ssb-project"></p>
<figcaption class="figure-caption">Figur&nbsp;2: GitHub-repo som er opprettet av ssb-project</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Når du har opprettet et nytt ssb-project, eller bygget et eksisterende prosjekt, så kan det ta rundt 30 sekunder før kernelen viser seg i Jupterlab-launcher. Vær tålmodig!</p>
</div>
</div>
</div>
</section>
</section>
<section id="installere-pakker" class="level2">
<h2 class="anchored" data-anchor-id="installere-pakker">Installere pakker</h2>
<p>Når du har opprettet et <strong>ssb-project</strong> så kan du installere de python-pakkene du trenger <a href="https://pypi.org/">fra PyPI</a>. Men før du installerer en pakke bør gjøre følgende for å sikre deg at du ikke installerer en pakke med skadelig kode:</p>
<ol type="1">
<li><p>Søk opp pakken på <a href="https://pypi.org/">PyPI</a>.</p></li>
<li><p>Sjekk om pakken er et populært/velkjent prosjekt ved å besøke repoet der koden ligger. Antall <em>Stars</em> og <em>Forks</em> på gitHub er en grei indikasjon på dette.</p></li>
<li><p>Hvis du er i tvil om pakken er trygg å installere, så kan du spørre kollegaer om de har erfaring med den, eller spørre på en egnet Yammer-kanal i SSB.</p></li>
<li><p>Hvis du fortsatt ønsker å installere pakken så anbefaler vi å <em>copy-paste</em> navnet fra PyPi, ikke skrive det inn manuelt når du installerer.</p></li>
</ol>
<p>Selve installeringen av pakken gjøres enkelt på følgende måte:</p>
<ol type="1">
<li>Åpne en terminal i Jupyterlab.</li>
<li>Gå inn i prosjektmappen din ved å skrive:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="op">&lt;</span>sti til prosjektmappe<span class="op">&gt;</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Lag en <em>branch</em>/utviklingsbranch som f.eks. heter <strong>install-pandas</strong>:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout <span class="at">-b</span> install-pandas</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li>Installer, f.eks. <strong>Pandas</strong>, ved å skrive følgende:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> add pandas</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ssb-proj-install" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/jupyterlab_terminal_install.png" class="img-fluid figure-img" alt="Bilde av et GitHub-repo som ble opprettet av ssb-project"></p>
<figcaption class="figure-caption">Figur&nbsp;3: Installasjon av Pandas med ssb-project</figcaption>
</figure>
</div>
<p><a href="#fig-ssb-proj-install">Figur&nbsp;3</a> viser hvordan dette vil se ut i en Jupyterlab-terminal. Kommandoen for å installere noe er <code>poetry add</code> etterfulgt av pakkenavnet. Vi ser også at den automatisk legger til Pandas-versjonen i filen <strong>poetry.lock</strong>.</p>
<p>Du kan også spesifisere en konkret versjon av pakken som skal installeres med følgende kommando:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> add pandas@1.2.3</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="avinstallere-pakker" class="level3">
<h3 class="anchored" data-anchor-id="avinstallere-pakker">Avinstallere pakker</h3>
<p>Ofte eksperimenterer man med nye pakker, og alle blir ikke med videre i produksjonskoden. Det er god praksis å fjerne pakker som ikke brukes, blant annet for å unngå at de blir en sikkerhetsrisiko. Det gjør du enkelt ved å skrive følgende i terminalen:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> remove pandas</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="oppdatere-pakker" class="level3">
<h3 class="anchored" data-anchor-id="oppdatere-pakker">Oppdatere pakker</h3>
<p>Hvis det kommer en ny versjon av en pakke du bruker, så kan du oppdatere den med følgende kommando:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> update pandas</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>hvis du kjører <code>poetry update</code> uten noe pakkenavn, så vil alle pakkene dine oppdateres til siste versjon, med mindre du har spesifisert versjonsbegrensninger i <strong>pyproject.toml</strong>-filen.</p>
</section>
<section id="undersøk-avhengigheter" class="level3">
<h3 class="anchored" data-anchor-id="undersøk-avhengigheter">Undersøk avhengigheter</h3>
<p>Hvis du lurer på hvilke pakker som har hvilke avhengigheter, så kan du lett liste ut dette i terminalen med følgende kommando:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> show <span class="at">--tree</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Det vil gi en grafisk fremstilling av avhengighetene som vist i <a href="#fig-ssb-proj-tree">Figur&nbsp;4</a>.</p>
<div id="fig-ssb-proj-tree" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/poetry-tree-cmd.png" class="img-fluid figure-img" alt="Bilde av en print i terminalen av avhengighetene mellom pakker i et ssb-project."></p>
<figcaption class="figure-caption">Figur&nbsp;4: Visning av pakke-avhengigheter i ssb-project</figcaption>
</figure>
</div>
</section>
</section>
<section id="push-til-github" class="level2">
<h2 class="anchored" data-anchor-id="push-til-github">Push til GitHub</h2>
<p>Når du nå har installert en pakke så har filen <strong>poetry.lock</strong> endret seg. For at dine samarbeidspartnere skal få tilgang til denne endringen i et SSB-project, så må du pushe en ny versjon av poetry.lock-filen opp Github, og kollegaene må pulle ned og <a href="./jobbe-med-kode.html#bygg-eksisterende-ssb-project">bygge prosjektet på nytt</a>. Du kan gjøre dette på følgende måte etter at du har installert en ny pakke:</p>
<ol type="1">
<li>Vi kan <em>stage</em> alle endringer med følgende kommando i terminalen når vi står i prosjektmappen:</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add <span class="at">-A</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Deretter <em>commit</em>e en endring, dvs. ta et stillbilde av koden i dette øyeblikket, ved å skrive følgende:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Installert pandas"</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Push det opp til GitHub<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Anta at vi gjorde dette i <em>branchen</em> <em>install-pandas</em> som ble opprettet tidligere. Da kan vi skrive følgende :</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">--set-upstream</span> origin install-pandas</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Deretter kan kollegaene dine pulle ned endringene og bygge prosjektet på nytt. Vi forklarer hvordan man kan bygge prosjektet på nytt senere i kapitlet.</p>
</section>
<section id="dependabot" class="level2">
<h2 class="anchored" data-anchor-id="dependabot">Dependabot</h2>
<p>Når man installerer pakker så vil det etter hvert utvikle seg et sett av potensielt kompliserte avhengigheter mellom disse pakkene. Dette skyldes at en pakke kan benytte seg av funksjonalitet i andre pakker, som igjen benytter seg av funksjonalitet i andre pakker, osv.. Hvis noen finner en sikkerhetssårbarhet i en pakke så kan det fikses ved at en ny versjon av den pakken slippes, som igjen kan få konsekvenser for pakker som er avhengig av denne.</p>
<p>I SSB er det tilrettelagt for at alle som versjonshåndterer koden sin på GitHub kan skanne pakkene sine for sårbarheter og nye versjoner av pakker med Dependabot. Dependabot hjelper oss med å finne og fikse sårbarheter og gamle pakkeversjoner. Dette er spesielt viktig når man installerer sine egne pakker.</p>
<p>Dependabot sjekker med jevne mellomrom om det finnes oppdateringer i pakkene som er listet i din <strong>pyproject.toml-fil</strong>, og den tilhørende <strong>poetry.lock</strong>. Hvis det finnes oppdateringer så vil den lage en <em>pull request</em> som du kan godkjenne. Når du godkjenner den så vil den oppdatere poetry.lock-filen og lage en ny <em>commit</em> som du kan <em>pushe</em> til GitHub. Dependabot gir også en sikkerhetsvarslinger hvis det finnes kjente sårbarheter i pakkene du bruker.</p>
<p>Det er anbefalt at alle som installerer sine egne pakker i SSB skrur på Dependabot i sine GitHub-repoer.</p>
<section id="aktivere-dependabot" class="level3">
<h3 class="anchored" data-anchor-id="aktivere-dependabot">Aktivere Dependabot</h3>
<p>Du kan aktivere Dependabot ved å gi inn i GitHub-repoet ditt og gjøre følgende:</p>
<ul>
<li>Gå inn repoet</li>
<li>Trykk på <strong>Settings</strong> for det repoet som vist på <a href="#fig-github-repo-settings-button">Figur&nbsp;5</a>.</li>
</ul>
<div id="fig-github-repo-settings-button" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/github_repo_settings_button.png" class="img-fluid figure-img" alt="Bilde av knappen man trykker på for å komme inn i repo-settings"></p>
<figcaption class="figure-caption">Figur&nbsp;5: Åpne <em>Settings</em> for et GitHub-repo.</figcaption>
</figure>
</div>
<ul>
<li><p>I menyen til venstre velger du <strong>Code security and analysis</strong></p></li>
<li><p>Under seksjonen <strong>Dependabot</strong> velger <strong>Enable</strong> på minst <strong>Dependabot alerts</strong> og <strong>Dependabot security updates</strong>, slik som vist i <a href="#fig-github-dependabot">Figur&nbsp;6</a>.</p></li>
</ul>
<div id="fig-github-dependabot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/github_dependabot.png" class="img-fluid figure-img" alt="Bilde som indikerer hvor man skrur på Dependabot i GitHub"></p>
<figcaption class="figure-caption">Figur&nbsp;6: Skru på Dependabot i GitHub.</figcaption>
</figure>
</div>
<p>Når du har gjort dette vil GitHub varsle deg hvis det finnes en kjent sårbarhet i pakkene som benyttes.</p>
</section>
<section id="oppdatere-pakker-1" class="level3">
<h3 class="anchored" data-anchor-id="oppdatere-pakker-1">Oppdatere pakker</h3>
<p>Hvis en av pakkene du bruker kommer med en oppdatering, så vil Dependabot lage en <em>pull request</em> (PR) i GitHub som du kan godkjenne. Dependabot sjekker også om oppdateringen er i konflikt med andre pakker du bruker. Hvis det er tilfellet så vil den lage en <em>pull request</em> som oppdaterer alle pakkene som er i konflikt.</p>
<p>Hvis en av pakkene du bruker har en kjent sikkerhetssårbarhet, så vil Dependabot varsle deg om dette under <strong>Security</strong>-fanen i GitHub-repoet ditt. Hvis du trykker på <strong>View Dependabot alerts</strong> så vil du få en oversikt over alle sårbarhetene som er funnet, og hvilken alvorlighetsgrad den har. Hvis du trykker på en av sårbarhetene så vil du få mer informasjon om den, og du kan trykke på <strong>Create pull request</strong> for å oppdatere pakken.</p>
<p>Som nevnt over kan du enkelt oppdatere pakker fra GitHub ved hjelp av Dependabot. Men det finnes tilfeller der du vil teste om en oppdatering gjør at deler av koden din ikke fungerer lenger. Anta at du bruker en Python-pakken <strong>Pandas</strong> i koden din, og at du får en <em>pull request</em> fra Dependabot om å oppdatere den fra versjon 1.5 til 2.0. Hvis du ønsker å teste om koden din fortsatt fungerer med den nye versjonen av <strong>Pandas</strong>, så kan du gjøre dette i Jupyterlab ved å følge ved å lage en branch som f.eks. heter <strong>update-pandas</strong>. Deretter kan du installere den nye versjonen av <strong>Pandas</strong> med følgende kommando fra terminalen:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> update pandas@2.0</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hvis du nå kjører koden din kan du teste om den fortsatt fungerer som forventet. Gjør den ikke det kan du tilpasse koden din og pushe endringene til Github. Deretter kan du godkjenne <em>pull requesten</em> fra Dependabot og merge den. Etter dette kan du slette den PR-en som Dependabot lagde for deg.</p>
</section>
</section>
<section id="bygg-eksisterende-ssb-project" class="level2">
<h2 class="anchored" data-anchor-id="bygg-eksisterende-ssb-project">Bygg eksisterende ssb-project</h2>
<p>Når vi skal samarbeide med andre om kode så gjør vi dette via <strong>GitHub</strong>. Når du <em>pusher</em> koden din til GitHub, så kan samarbeidspartnere <em>pulle</em> ned koden og jobbe videre med den. Men når de henter ned koden så vil de bare hente ned selve koden, ikke pakker og Python-versjonen som ble brukt. De må installere alt som du hadde installert. I tillegg trenger de en kernel hvis de skal jobbe i Jupyterlab. <strong>ssb-project</strong> gjør det svært enkelt å bygge opp det du trenger, siden det virtuelle miljøet har all informasjon om hva som trengs.</p>
<p>For at samarbeidspartneren din skal kunne bygge miljøet på nytt, må de ha gjort en minimal konfigurering av Git. <a href="./git-og-github.html#oppsett-av-git">Les mer om hvordan</a> du frem for å gjøre dette her.</p>
<p>For å bygge opp et eksisterende miljø gjør du følgende:</p>
<ol type="1">
<li>Først må du kopiere prosjektet ned lokalt, eller <em>klone</em> repoet med git-terminologi</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/statisticsnorway/<span class="op">&lt;</span>prosjektnavn<span class="op">&gt;</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Gå inn i mappen du klonet</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="op">&lt;</span>prosjektnavn<span class="op">&gt;</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>Skape et virtuelt miljø og installere en tilsvarende Jupyter kernel med</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssb-project</span> build</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="slette-ssb-project" class="level2">
<h2 class="anchored" data-anchor-id="slette-ssb-project">Slette ssb-project</h2>
<p>Det vil være tilfeller hvor man ønsker å slette et ssb-project, enten fordi man ikke trenger koden lenger eller fordi man bare testet litt.</p>
<section id="lokalt" class="level3">
<h3 class="anchored" data-anchor-id="lokalt">Lokalt</h3>
<p>Hvis man jobber med flere prosjekter så kan det fort bli mange Jupyter kerneler hengende igjen. Derfor er det også mulighet å kjøre</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ssb-project</span> clean stat-testprod</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>som sletter Jupyter-kernelen og de installerte pakkene i prosjektet. Hvis du også ønsker å slette selve mappen med kode må du gjøre det manuelt<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> ~/stat-testprod/</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Prosjektmappen over lå direkte i hjemmemappen min og hjemmemappen på Linux kan alltid referes til med et tilda-tegn <strong>~</strong>.</p>
</section>
<section id="arkiver-github-repo" class="level3">
<h3 class="anchored" data-anchor-id="arkiver-github-repo">Arkiver GitHub-repo</h3>
<p>GitHub-repoer som er opprettet under SSB sin organinasjons <a href="">statisticsnorway</a> på GitHub kan ikke slettes, bare arkiveres. Grunnen er at hvis man oppdager en sårbarhet senere så er det viktig å kunne se repoet for å forstå hva som har skjedd.</p>
<p>Hvis du ikke trenger et GitHub-repo lenger kan man <strong>arkivere repoet</strong>. Det gjør du på følgende måte:</p>
<ol type="1">
<li>Gi inn i repoet <strong>Settings</strong> slik som vist med rød pil i <a href="#fig-github-repo-settings">Figur&nbsp;7</a>.</li>
</ol>
<div id="fig-github-repo-settings" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/github_repo_settings.png" class="img-fluid figure-img" alt="Bilde som viser hvor Settings til et spesifikt repo"></p>
<figcaption class="figure-caption">Figur&nbsp;7: Settings for repoet.</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>Under <strong>General</strong> scroller du deg ned til delen som heter <strong>Danger Zone</strong> og velger <strong>Archive this repository</strong>, slik som vist på <a href="#fig-github-repo-settings-archive">Figur&nbsp;8</a>.</li>
</ol>
<div id="fig-github-repo-settings-archive" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./images/github_repo_settings_archive.png" class="img-fluid figure-img" alt="Bilde som viser hvordan man arkiverer et repo."></p>
<figcaption class="figure-caption">Figur&nbsp;8: Arkivering av et repo.</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>I dialogboksen som dukker opp fyller du inn reponavnet som beskrevet og trykker på <strong>I understand the consequences, archive this repository</strong>.</li>
</ol>
<p>Når det er gjort så er repoet lesbart, men man kan ikke jobbe med det. Men som vi ser av @#fig-github-repo-settings-archive-warning kan man omgjøre arkiveringen senere hvis det skulle være ønskelig.</p>
</section>
</section>
<section id="spark-i-ssb-project" class="level2">
<h2 class="anchored" data-anchor-id="spark-i-ssb-project">Spark i ssb-project</h2>
<p>For å kunne bruke <a href="./spark.html">Spark</a> i et <strong>ssb-project</strong> må man først installere <a href="https://spark.apache.org/docs/latest/api/python/index.html">pyspark</a>. Det gjør du ved å skrive følgende i en terminal:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">poetry</span> add pyspark==<span class="va">$(</span><span class="ex">pip</span> show pyspark <span class="kw">|</span> <span class="fu">grep</span> Version <span class="kw">|</span> <span class="fu">egrep</span> <span class="at">-o</span> <span class="st">"([0-9]{1,}\.)+[0-9]{1,}"</span><span class="va">)</span> <span class="at">--no-dev</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Her installerer du samme versjon av pyspark som på Jupyterlab.</p>
<p>Videre kan vi konfigurere Spark til å enten kjøre på lokal maskin eller på flere maskiner (såkalte <em>clusters</em>). Under beskriver vi begge variantene.</p>
<section id="lokal-maskin" class="level3">
<h3 class="anchored" data-anchor-id="lokal-maskin">Lokal maskin</h3>
<p>Oppsettet for Pyspark på lokal maskin er det enkleste å sette opp siden Pyspark vil ha direkte tilgang til det lokale filsystemet. Man kan bruke miljøvariabelen <code>PYSPARK_PYTHON</code> til å peke på det virtuelle miljøet, og dermed vil Pyspark også ha tilgang til alle pakkene som er installert der. I en notebook vil dette kunne settes opp slik:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Finner filstien til det virtuelle miljøet</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>python_path <span class="op">=</span> subprocess.run([<span class="st">'poetry'</span>, <span class="st">'run'</span>, <span class="st">'which'</span>, <span class="st">'python'</span>],</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                             capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>).stdout.rstrip(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"PYSPARK_PYTHON"</span>] <span class="op">=</span> python_path</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"PYSPARK_SUBMIT_ARGS"</span>] <span class="op">=</span> os.environ[<span class="st">"PYSPARK_LOCAL_SUBMIT_ARGS"</span>]</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Når du oppretter en Notebook og bruker den kernelen du har laget så må du alltid ha denne på toppen av notebooken. Det initialiserer Spark slik at det kan brukes i notebooken.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>run <span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>share<span class="op">/</span>jupyter<span class="op">/</span>kernels<span class="op">/</span>pyspark_local<span class="op">/</span>init.py</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Dette scriptet vil sette et <code>spark</code> objekt som brukes for å kalle API’et til pyspark.</p>
</section>
<section id="cluster" class="level3">
<h3 class="anchored" data-anchor-id="cluster">Cluster</h3>
<p>Hvis man vil kjøre Pyspark i et cluster (dvs. på flere maskiner) så vil databehandlingen foregå på andre maskiner som ikke har tilgang til det lokale filsystemet. Man må dermed lage en “pakke” av det virtuelle miljøet på lokal maskin og tilgjengeliggjøre dette for alle maskinene i clusteret. For å lage en slik “pakke” kan man bruke et bibliotek som heter <code>venv-pack</code>. Dette kan kjøres fra et terminalvindu slik:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">venv-pack</span> <span class="at">-p</span> .venv <span class="at">-o</span> pyspark_venv.tar.gz</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Merk at kommandoen over må kjøres fra rot-mappen i prosjektet ditt. Her er <code>pyspark_venv.tar.gz</code> et tilfeldig valgt filnavn, men dette filnavnet skal brukes videre i notebooken.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Miljøvariabel som peker på en utpakket versjon av det virtuelle miljøet</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"PYSPARK_PYTHON"</span>] <span class="op">=</span> <span class="st">"./environment/bin/python"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Legg til et flagg, --archives, som peker på "pakken" med det virtuelle miljøet</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> os.environ[<span class="st">"PYSPARK_K8S_SUBMIT_ARGS"</span>].split(<span class="st">' '</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>last_index <span class="op">=</span> conf.index(<span class="st">'pyspark-shell'</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>conf[last_index:last_index] <span class="op">=</span> [<span class="st">'--archives'</span>, <span class="st">'pyspark_venv.tar.gz#environment'</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">"PYSPARK_SUBMIT_ARGS"</span>] <span class="op">=</span> <span class="st">' '</span>.join(conf)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Når du oppretter en Notebook og bruker den kernelen du har laget så må du alltid ha denne på toppen av notebooken. Det initialiserer Spark slik at det kan brukes i notebooken.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>run <span class="op">/</span>usr<span class="op">/</span>local<span class="op">/</span>share<span class="op">/</span>jupyter<span class="op">/</span>kernels<span class="op">/</span>pyspark_k8s<span class="op">/</span>init.py</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Dette scriptet vil sette et <code>spark</code> objekt som brukes for å kalle API’et til pyspark.</p>
</section>
</section>
<section id="tips-og-triks" class="level2">
<h2 class="anchored" data-anchor-id="tips-og-triks">Tips og triks</h2>
<p>I denne delen av kapitlet vil vi gi deg noen tips og triks som kan være nyttige når du jobber med <strong>ssb-project</strong>.</p>
<section id="poetry" class="level3">
<h3 class="anchored" data-anchor-id="poetry">Poetry</h3>
<p><strong>ssb-project</strong> bruker <a href="https://python-poetry.org/docs/">Poetry</a> for å håndtere virtuelle miljøer. Poetry er et verktøy som gjør det enkelt å installere pakker og håndtere versjoner av disse. Det er også Poetry som håndterer Jupyter-kernelen for deg.</p>
<p>Hvis du etterlyser funksjonalitet i et ssb-project så kan det være nyttig å lese dokumentasjonen til Poetry for å se om det er mulig å få til det du ønsker.</p>
</section>
<section id="full-disk-på-dapla" class="level3">
<h3 class="anchored" data-anchor-id="full-disk-på-dapla">Full disk på Dapla</h3>
<p><a href="./hva-er-botter.html#lokalt-filsystem-på-dapla">Det “lokale” filsystemet</a> på Dapla har kun <strong>10GB</strong> diskplass. Har du mange virtuelle miljøer på denne disken kan det fort bli fullt, siden alle pakker blir installert her. Vanligvis er det 2 grunner til at disken blir full:</p>
<ol type="1">
<li><p><strong>For mange virtuelle miljøer (ssb-projects) lagret lokalt.</strong><br>
Dette vil ofte kunne løses ved å <a href="./jobbe-med-kode.html#slette-ssb-project">slette virtuelle miljøer</a> som ikke lenger er i bruk. Hvis du har 5 virtuelle miljøer som hver bruker 1GB, og du kun jobber på en av de nå, så vil du frigjøre 40% av disken ved å slette 4 av dem. Husk at det permanente lagringsstedet for kode er på GitHub, og du kan alltid klone ned et prosjekt senere og bygge det hvis det trengs.</p></li>
<li><p><strong><code>/home/jovyan/.cache/</code> har blitt for stort.</strong><br>
Dette er en mappe som brukes av applikasjoner til å lagre midlertidig data slik at de kan kjøre raskere. Denne kan bli ganske stor etter hvert. Ofte kan man frigjøre flere GB ved å slette denne. Du sletter denne mappen ved å skrive følgende i en terminal:</p></li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> /home/jovyan/.cache/</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hvis du opplever at disken er full, så kan det anbefales å undersøke hvilke mapper som tar størst plass med følgende kommando i terminalen:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~ <span class="kw">&amp;&amp;</span> <span class="fu">du</span> <span class="at">-h</span> <span class="at">--max-depth</span><span class="op">=</span>5 <span class="kw">|</span> <span class="fu">sort</span> <span class="at">-rh</span> <span class="kw">|</span> <span class="fu">head</span> <span class="at">-n</span> 10 <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> <span class="at">-</span></span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Kommandoen over sjekker, fra hjemmemappen din, hvilke mapper og undermapper som tar mest plass. Den viser de 10 største mappene. Hvis du ønsker å se flere mapper så kan du endre tallet etter <strong>head -n</strong>. Hvis du ønsker å se alle mapper så kan du fjerne <strong>head -n</strong>. <code>--max-depth=5</code> betyr at den kun sjekker mapper som er 5 mapper dype fra hjemmemappen din.</p>
<p>Når du har gjort det kan selv vurdere hvilke som kan slettes for å frigjøre plass.</p>
</section>
<section id="hold-prosjektet-oppdatert" class="level3">
<h3 class="anchored" data-anchor-id="hold-prosjektet-oppdatert">Hold prosjektet oppdatert</h3>
<p>Hvis du sitter med en lokal kopi av prosjektet ditt, og flere andre jobber med den samme kodebasen, så er det viktig at du holder din lokale kopi oppdatert. Hvis du jobber i en branch på en lokal kopi, bør du holde denne oppdatert med main-branchen på GitHub. Det er vanlig Git-praksis. Når man også bruker <strong>ssb-project</strong>, så man huske å også bygge prosjektet på nytt hver gang det er endringer som er gjort av andre i <code>poetry.lock.</code>-filen.</p>
</section>
</section>
</section>
<section id="r-og-renv" class="level1">
<h1>R og renv</h1>
<p>Installering av pakker for R-miljøet i Jupyterlab er foreløpig ikke en del av <a href="https://github.com/statisticsnorway/ssb-project-cli">ssb-project</a> enda. Men vi kan bruke <a href="https://rstudio.github.io/renv/articles/renv.html">renv</a> til dette. renv er et verktøy som lar oss opprette et virtuelt miljø for R og installere pakker. Det er anbefalt å bruke renv for å sikre at alle som jobber med prosjektet har samme versjon av pakkene. I tillegg er det enkelt å dele prosjektet med andre.</p>
<p>Oppretting av renv-miljø og installering av pakker anbefales å gjøres fra terminal. Dette er fordi det trengs å gjøres kun en gang per prosjekt. For å starte R i terminalen i Jupyter/DAPLA:</p>
<ol type="1">
<li>Åpne en terminal fra Launcher</li>
<li>Stå i mappen der du vil aktivere det virtuelle miljøet/installere pakker, dvs prosjekt mappen.</li>
<li>Starte R ved å skrive in <code>R</code></li>
</ol>
<p>Det vi nå har gjort er å åpne <strong>R</strong> fra terminalen slik at vi kan skrive R-kode direkte i terminalen. Det omtales ofte som en <em>R Console</em>. I RStudio finne du terminalen i fanen ved siden av “Console”.</p>
<section id="starte-en-ny-renv" class="level3">
<h3 class="anchored" data-anchor-id="starte-en-ny-renv">Starte en ny renv</h3>
<p>For å installere dine egne R-pakker må du opprette et virtuelt miljø med <strong>renv</strong>. Dette kan gjøres ved å skriver:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Kommandoen aktiverer et virtuelt miljø i mappen du står i. Rent praktisk vil det si at du fikk følgende filer/mapper i mappen din:</p>
<ul>
<li><p><strong>renv.lock</strong><br>
En fil som inneholder versjoner av alle pakker du benytter i koden din.</p></li>
<li><p><strong>.Rprofile</strong> En fil som inneholder informasjon om oppsetting av miljø og alternative.</p></li>
<li><p><strong>renv</strong><br>
Mappe som inneholder alle pakkene du installerer.</p></li>
<li><p><strong>renv/activate.R</strong> En fil som aktivere renv miljø for et prosjekt.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hvis prosjektet ligger på GitHub, skal filene <code>renv.lock</code>, <code>.Rprofile</code> og <code>renv/activate.R</code> være på GitHub.</p>
</div>
</div>
</section>
<section id="installering-av-pakker" class="level3">
<h3 class="anchored" data-anchor-id="installering-av-pakker">Installering av pakker</h3>
<p>Nå som vi har et virtuelle miljøet på plass kan vi installere R-pakker. På Dapla installeres R-pakker fra en av to steder:</p>
<ol type="1">
<li>https://packagemanager.rstudio.com/all/latest</li>
<li>https://cran.uib.no</li>
</ol>
<p>Vi installere pakker med funksjonen <code>renv::install()</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"PxWebApiData"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Dette installerer pakken <a href="https://cran.r-project.org/web/packages/PxWebApiData/vignettes/Introduction.html">PxWebApiData</a> i det virtuelle miljøet. Dette er en pakke skrevet for å hente ut data fra SSBs statistikkbank.</p>
<p>Det er også mulig å installere pakker som ligger på SSBs GitHub. Da må vi spesifisere at pakke ligger på ‘statisticsnorway’ område. For eksempel:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"statisticsnorway/klassR"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pakken <a href="https://statisticsnorway.github.io/klassR/articles/klassR-vignette.html">klassR</a> er skrevet for å hente ut klassifikasjoner fra SSBs KLASS. Det er en public repository på Github og åpen for alle å laste ned.</p>
<p>Hvis prosjekt er opprettet av noen andre, og har blitt delt med deg, kan alle pakkene i prosjektet installeres ved:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">:</span><span class="fu">restore</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hvis du selv har ikke benyttet renv i prosjektet tidligere må du kjøre <code>renv::init()</code> på forhånd.</p>
</section>
<section id="lagre-pakkeversjonen-til-renv" class="level3">
<h3 class="anchored" data-anchor-id="lagre-pakkeversjonen-til-renv">Lagre pakkeversjonen til renv</h3>
<p>For å lagre pakkeversjon til .lockfil må koden din benytte pakken ved funksjonen <code>library()</code> et sted i prosjektet (på en .R fil). For eksempel kan vi benytte pakken <code>PxWebApiData</code> i koden vår ved:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PxWebApiData)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ApiData</span>(<span class="st">"https://data.ssb.no/api/v0/en/table/04861"</span>, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">Region =</span> <span class="fu">c</span>(<span class="st">"1103"</span>, <span class="st">"0301"</span>), <span class="at">ContentsCode =</span> <span class="st">"Bosatte"</span>, <span class="at">Tid =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For å legge pakken inn i .lockfilen skriver vi i R på terminal:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Det betyr at både du og andre kan gjennskape de pakkene og versjoner som du har installerte. Kikker du nå inne i <strong>renv.lock</strong>-filen så ser du nå at verjsonen av <strong>PxWebApiData</strong> er lagt til. I bildet under ser du hvordan et arbeidsmiljø typisk kan se ut når man installerer sine egne pakker.</p>
<p><img src="images/renv_install.png" class="img-fluid"></p>
</section>
<section id="avinstallering" class="level3">
<h3 class="anchored" data-anchor-id="avinstallering">Avinstallering</h3>
<p>Individuelle pakker kan fjernes fra miljø ved <code>renv::</code>remove()` funksjonen. For eksempel:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">remove</span>(<span class="st">"PxWebApiData"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For å fjerne fra <strong>renv.lock</strong>-filen også må du ta en <code>snapshot()</code> etterpå.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>En annen nyttig funksjon er <code>renv::clean()</code>. Dette fjerner alle pakker fra library som ikke er i bruk</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">clean</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Igjen må du ta en <code>snapshot()</code> for at endringer skal lagres på <strong>renv.lock</strong>-filen</p>
</section>
<section id="oppgradere-pakker" class="level3">
<h3 class="anchored" data-anchor-id="oppgradere-pakker">Oppgradere pakker</h3>
<p>For å oppgradere en pakke kan du bruke <code>renv::update()</code>. For eksempel å oppgradere <code>PxWebApiData</code> skriv:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">update</span>(<span class="st">"PxWebApiData"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For å installere et spesifikk versjon av en pakke kan du spesifisere dette med installering med <code>@</code> og versjonsnummer. For eksempel å installere <code>PxWEbApiData</code> versjon 0.4.0:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">install</span>(<span class="st">"PxWebApiData@0.4.0"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Husk å ta en <code>snapshot()</code> etterpå for å lagre endringer til <strong>renv.lock</strong>-filen. Det betyr at du og andre kan gjenskape miljø på nytt.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="hva-skal-stå-i-kjørekoden" class="level3">
<h3 class="anchored" data-anchor-id="hva-skal-stå-i-kjørekoden">Hva skal stå i kjørekoden?</h3>
<p>Koden over kan kjøres fra R i terminal og skal kun kjøres en gang. Men for å aktivere miljø og pakker som skal brukes må det aktiveres ved starten av koden din. I RStudio går dette automatisk ved hjelp av .Rprofile filen. I JupyterLab når du åpne en .R-fil som en notebook må det aktiveres ved for eksempel:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">autoload</span>()</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Deretter kan du benytte pakker og funksjoner ved <code>library()</code> osv. Funkjsonen <code>renv::autoload()</code> vil si ifra at du ønsker å benytte et renv miljø og vil letter etter filene i prosjektetfor å aktivere miljø (både i prosjekt-mappen og i foreldre-mapper).</p>
<p>For å dele koden med andre, må de også kjøre <code>renv::restore()</code> (første gang) for å installere alle pakkene som ligger i .lock filen.</p>
</section>
<section id="r-på-bakken" class="level3">
<h3 class="anchored" data-anchor-id="r-på-bakken">R på bakken</h3>
<p>Prosessen med å installere pakker for R på bakken er det samme som <a href="./pakke-install.html#r">på Dapla</a>. Noen pakker (for eksempel <code>devtools</code>) kan foreløpig ikke installeres på bakken på egenhånd pga 3. parti avhengigheter. Vi jobber med å finne en løsning til dette.</p>
<p>For å installere <code>arrow</code>, kopier og kjør følgende kommando i R:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"/ssb/bruker/felles/R_pakker/arrow_11.0.0.2.tar.gz"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">repos =</span> <span class="cn">NULL</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">"source"</span>)</span></code><button title="Kopier til utklippstavle" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Fotnoter</h2>

<ol>
<li id="fn1"><p>En kernel refererer til en Python- eller R-installasjon som er optimalisert for bruk med Jupyterlab Notebooks.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>CLI = Command-Line-Interface, som betyr et program designet for bruk i terminalen med kommandoer.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Filer og mapper som starter med punktum er skjulte med mindre man ber om å se dem. I Jupyterlab kan disse vises i filutforskeren ved å velge <strong>View</strong> fra menylinjen, og deretter velge <strong>Show hidden files</strong>. I en terminal skriver man <code>ls -a</code> for å se de.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Å pushe til GitHub uten å sende ved <em>Personal Access Token</em> fordrer at du har lagret det lokalt så Git kan finne det. <a href="./git-og-github.html#lagre-pat">Her et eksempel på hvordan det kan gjøres</a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Dette kan også gjøres ved å høyreklikke på mappen i Jupyterlab sin filutforsker og velge <strong>Delete</strong>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Kom i gang med Dapla</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>